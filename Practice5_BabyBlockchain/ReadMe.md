## **1. Обзор и назначение программной системы**


Данный программный продукт являет собой демонстрационную версию системы, которая позволяет совершать транзакции использую новосозданную цифровую валюту используя технологию Blockchain. Система будет представлять собой два программных продукта.

Первый продукт – это полный узел сети, который будет валидировать транзакции, формировать блоки из них и хранить эти блоки в виде Blockchain.

Второй продукт – это клиентское приложение с простым графическим интерфейсом, которое будет выполнять функции цифрового кошелька. Его ключевыми функциями будет генерация ключей (приватного и публичного), формирование и подписывание транзакций с последующей их отправкой на полный узел. Кроме того, «цифровой кошелек» должен обеспечивать просмотр баланса пользователя.

Взаимодействие двух частей программной системы будет происходить через REST.API.

## **2. Пользователи системы**


Даная система является сугубо демонстрационной и не может быть использована реальными пользователями.
В то же время, система с похожими принципами функционирования может быть использована неколькими типами пользователей.

̶	_**Обычные пользователи**_ – пользователи системы, цель которых просто в том, чтобы создавать и принимать транзакции. Они будут использовать исключительно клиентское приложение кошелька и не будут разворачивать полный узел сети.

̶	_**Валидаторы** – пользователи_, ключевая цель которых валидировать транзакции и продлевать блокчейн, создавая новые блоки. За это они будут получать вознаграждение. Данный тип пользователей должен полностью развернуть полный узел сети и работать с распределенной БД блокчейна. При этом валидаторы также используют цифровой кошелек, а значит могут выступать в роле обычных пользователей.

̶	_**Аудиторы**_ – могут проводить полный аудит системы, подняв у себя полный узел, однако не принимают участия в валидации блоков.


## **3.	Функции программной системы**

### **3.1 Функции цифрового кошелька**


**_F1: Генерация пары ключей._**

Цифровой кошелек должен реализовывать функциональность создания пары ключей (публичного – который будет выступать в качестве адреса и с помощью него будет проверятся цифровая подпись, и приватного – с помощью которого будут подписываться транзакции). Для создания ключей и подписи транзакций должен быть использован алгоритм RSA.


**_F2: Формирование и подпись транзакций_**

Цифровой кошелек должен позволять пользователям формировать транзакции на другой адрес. При этом в одной транзакции может быть выполнено несколько операций. Транзакция должна быть подписана с использованием цифровой подписи с помощью приватного ключа.

**_F3: Отправка транзакций в блокчейн_**

Кошелек должен уметь отправлять сформированные и подписанные транзакции на полный узел используя протокол HTTP и REST API.

**_F4: Отображение баланса пользователя_**

Цифровой кошелек должен поддерживать отображение баланса пользователей. Для этого он должен хранить у себя в базе данных список всех транзакций данного пользователя и уметь высчитать баланс. Также должна быть возможность синхронизации этой информации с полным узлом системы.

### **3.2 Функции приложения, реализующего полный узел сети**

**_F5: Прием входящих транзакций_**

Полный узел должен иметь REST эндпойнт для того, чтобы принимать входящие транзакции от цифровых кошельков.

**_F6: Формирование очереди транзакции_**

При получении транзакции полным узлом сети, она должна становится в очередь и ждать момента, когда будет обработана и добавлена в блок, или же отклонена.

**_F7: Формирование блоков_**

При формировании блока, приложение должно брать транзакции из очереди. Берется не более 4 транзакций за раз. Если в очереди транзакций их меньше, то берется меньшее количество. Блок должен ссылаться на предыдущий блок по его хеш-значению. Для получения хеш-значений использовать алгоритм SHA-256.

**_F8: Валидация транзакций_**

При добавлении в блок транзакция должна пройти валидацию. В валидацию включается проверка цифровой подписи, а также факт того, что транзакция не платит больше, чем есть на балансе. Правильные транзакции добавляются в блок и удаляются из очереди, неправильные – просто удаляются из очереди.

**_F9: Proof of Work_**

Когда блок сформирован, должно быть выполнено доказательство работы. Для этого в блок добавим числовое поле и у будем увеличивать его, пока хеш от блока не будет начинаться с некоторого количества нулей. Количество будет определено практическим путем, чтобы нахождение занимало примерно 20-30 секунд.

**_F9: Валидация блока_**

Перед добавлением в цепочку – блок проверяется на соответствие следующим условиям:

- Проверка что блок содержит ссылку на последний актуальный блок в истории;
- Проверка что транзакции в блоке еще не были добавлены в историю;
- Проверка того, что блок не содержит конфликтующих транзакций.
- Проверка ProofOfWork

**_F10: Добавление блоков в цепочку_**

После валидации блока он должен быть добавлен в цепочку блоков. Бля хранения блоков использовать нереляционную базу данных MongoDb.

**_F11: Получение тестовых токенов на указанный адрес_**

В системе должен быть предусмотрен эндпойнт, который принимает публичный ключ пользователя, сумму, и создает транзакцию о начислении этому пользователю нужного количества тестовых токенов.

**_F12: Синхронизация баланса цифровых кошельков_**

Система должна иметь эндпойнт, который бы возвращал все транзакции данного пользователя для того, чтобы кошельки могли синхронизироваться с полным узлом и пересчитать баланс пользователя.

## **4. Границы системы**

В первом релизе должна быть реализована вся функциональность, которая была заявлена в пункте 3 данного документа. Кроме того, если будет время, то опционально может быть реализован графический интерфейс для взаимодействия с полным узлом сети. По умолчанию оно происходит через REST.API с помощью Postman или Swagger.

## **5. Требования безопасности**


Так как система разрабатывается для обучающих целей, существенных требований к ее безопасности не выдвигается.

## **6. Ограничения**


Система должна быть реализована с использованием платформы .NET 6 и языка программирования C#. Для реализации графического интерфейса пользователя для электронного кошелька использовать технологию Windows Forms. Для реализации REST API использовать фреймворк ASP.NET Core. В качестве хранилища данных использовать MongoDb.
Для реализации алгоритмов криптографии и хеширования должны быть использованы встроенные библиотеки платформы .NET.

